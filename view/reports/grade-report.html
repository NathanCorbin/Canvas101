<div class="card z-depth-3">
    <canvas id="myChart"></canvas>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
<script>

    function sortJSON(array, key) {
        return array.sort(function(a, b) {
            var x = a[key]; var y = b[key];
            return ((x < y) ? -1 : ((x > y) ? 1 : 0));
        });
    }

    var ctx = document.getElementById("myChart").getContext('2d');

    var data = {{ json_encode(@data, JSON_PRETTY_PRINT) }};
    
    data = sortJSON(data, 'grade');

    var grades = data.map(function(element) {
       return element.grade;
    });

    var names = data.map(function(element) {
        return element.name;
    });

    const colors = grades.map((value) => Math.floor(value) <= 65 ? 'rgba(165, 70, 70, .65)' 
                                        : (Math.floor(value) < 80 ? 'rgba(235, 235, 20, .65)' : 'rgba(40, 160, 5, .55)'));
    
    Chart.defaults.global.legend.display = false;
    Chart.defaults.global.defaultFontColor = "#fff";

    var horizontal = false;

    if(window.innerHeight > window.innerWidth)
        horizontal = false;
    else
        horizontal = true;

    var myChart = new Chart(ctx, {
        type: horizontal == true ? 'horizontalBar' : 'bar',
        data: {
            labels: names,
            datasets: [{
                data: grades,
                backgroundColor: colors,
                borderWidth: 2
            }]
        },
        options: {
            title: {
                display: true,
                text: 'Assignment Report For {{ @courseName }}',
                fontSize: 20
            },
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero:true
                    }
                }],
                xAxes: [{
                    ticks: {
                        beginAtZero:true,
                        autoSkip: false
                    }
                }]
            },
            responsive:true,
            scaleFontColor: "#FFFFFF"
            
        }
    });
    
</script>